Restructure internal Registry query system methods to share code better and prepare for more meaningful changes.
